<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MeCoin Retrieval</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background: #000000;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .container {
      text-align: center;
      max-width: 400px;
      width: 100%;
    }

    .score {
      font-size: 48px;
      font-weight: bold;
      margin-bottom: 30px;
      text-shadow: 0 0 10px rgba(255,215,0,0.5);
      color: #FFD700;
    }

    .coin-button {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #FFD700, #D4AF37, #B8860B);
      border: 4px solid #FFD700;
      cursor: pointer;
      font-size: 20px;
      font-weight: bold;
      color: #8B7500;
      box-shadow:
        0 0 30px rgba(255,215,0,0.5),
        inset 0 0 20px rgba(255,255,255,0.3);
      transition: all 0.1s ease;
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }

    .coin-button:before {
      content: '';
      position: absolute;
      top: 10%;
      left: 10%;
      right: 10%;
      bottom: 10%;
      background: radial-gradient(ellipse at center, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 70%);
      border-radius: 50%;
    }

    .coin-button:after {
      content: '‚Çø';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 60px;
      color: #8B7500;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .coin-button:active {
      transform: scale(0.95) rotate(5deg);
      box-shadow:
        0 0 15px rgba(255,215,0,0.3),
        inset 0 0 10px rgba(255,255,255,0.2);
    }

    .stats {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      margin-top: 20px;
      border: 1px solid rgba(255,215,0,0.3);
    }

    .stats p {
      margin: 10px 0;
      font-size: 18px;
      color: #FFD700;
    }

    h1 {
      margin-bottom: 30px;
      text-shadow: 0 0 10px rgba(255,215,0,0.5);
      color: #FFD700;
      font-size: 28px;
    }

    .reset-button {
      background: linear-gradient(145deg, #FFD700, #D4AF37);
      border: none;
      color: #000;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      margin-top: 15px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255,215,0,0.3);
    }

    .reset-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255,215,0,0.4);
    }

    .stats span {
      color: white;
      font-weight: bold;
    }

    .shop-button {
      background: linear-gradient(145deg, #4CAF50, #45a049);
      border: none;
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      margin: 10px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(76,175,80,0.3);
    }

    .shop-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76,175,80,0.4);
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a1a1a;
      padding: 30px;
      border-radius: 20px;
      border: 2px solid #FFD700;
      max-width: 350px;
      width: 90%;
      text-align: center;
    }

    .close-button {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 24px;
      color: #FFD700;
      cursor: pointer;
      background: none;
      border: none;
    }

    .shop-item {
      background: rgba(255,255,255,0.1);
      padding: 15px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid rgba(255,215,0,0.3);
    }

    .buy-button {
      background: linear-gradient(145deg, #FFD700, #D4AF37);
      border: none;
      color: #000;
      padding: 8px 16px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      margin-top: 8px;
      transition: all 0.3s ease;
    }

    .buy-button:disabled {
      background: #666;
      cursor: not-allowed;
    }

    .buy-button:hover:not(:disabled) {
      transform: translateY(-2px);
    }

    .boost-info {
      font-size: 14px;
      color: #aaa;
      margin-top: 5px;
    }

    .buttons-row {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>MeCoin Retrieval</h1>

  <div class="score" id="score">0</div>

  <button class="coin-button" id="tapButton"></button>

  <div class="buttons-row">
    <button class="shop-button" id="shopButton">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
    <button class="reset-button" id="resetButton">–°–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç</button>
  </div>

  <div class="stats">
    <p>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤: <span id="totalClicks">0</span></p>
    <p>–ö–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É: <span id="clicksPerSecond">0</span></p>
    <p>–†–µ–∫–æ—Ä–¥: <span id="record">0</span></p>
    <p>–£—Å–∏–ª–∏—Ç–µ–ª—å: <span id="boostLevel">1x</span></p>
    <p>–ú–æ–Ω–µ—Ç–∫–∏: <span id="coins">0</span> ü™ô</p>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞–≥–∞–∑–∏–Ω–∞ -->
<div class="modal" id="shopModal">
  <div class="modal-content">
    <button class="close-button" id="closeShop">&times;</button>
    <h2>üõí –ú–∞–≥–∞–∑–∏–Ω —É—Å–∏–ª–∏—Ç–µ–ª–µ–π</h2>
    
    <div class="shop-item">
      <h3>‚ö° –£—Å–∏–ª–∏—Ç–µ–ª—å x2</h3>
      <p>–î–∞–µ—Ç 2 –º–æ–Ω–µ—Ç–∫–∏ –∑–∞ –∫–ª–∏–∫</p>
      <p class="boost-info">–¶–µ–Ω–∞: 1000 –º–æ–Ω–µ—Ç–æ–∫</p>
      <button class="buy-button" id="buyBoost2" data-cost="1000" data-multiplier="2">
        –ö—É–ø–∏—Ç—å –∑–∞ 1000 ü™ô
      </button>
    </div>

    <div class="shop-item">
      <h3>‚ö°‚ö° –£—Å–∏–ª–∏—Ç–µ–ª—å x5</h3>
      <p>–î–∞–µ—Ç 5 –º–æ–Ω–µ—Ç–æ–∫ –∑–∞ –∫–ª–∏–∫</p>
      <p class="boost-info">–¶–µ–Ω–∞: 5000 –º–æ–Ω–µ—Ç–æ–∫</p>
      <button class="buy-button" id="buyBoost5" data-cost="5000" data-multiplier="5">
        –ö—É–ø–∏—Ç—å –∑–∞ 5000 ü™ô
      </button>
    </div>

    <div class="shop-item">
      <h3>‚ö°‚ö°‚ö° –£—Å–∏–ª–∏—Ç–µ–ª—å x10</h3>
      <p>–î–∞–µ—Ç 10 –º–æ–Ω–µ—Ç–æ–∫ –∑–∞ –∫–ª–∏–∫</p>
      <p class="boost-info">–¶–µ–Ω–∞: 10000 –º–æ–Ω–µ—Ç–æ–∫</p>
      <button class="buy-button" id="buyBoost10" data-cost="10000" data-multiplier="10">
        –ö—É–ø–∏—Ç—å –∑–∞ 10000 ü™ô
      </button>
    </div>

    <div class="shop-item">
      <h3>üí∞ –ë–æ–Ω—É—Å–Ω—ã–µ –º–æ–Ω–µ—Ç–∫–∏</h3>
      <p>+1000 –º–æ–Ω–µ—Ç–æ–∫ —Å—Ä–∞–∑—É</p>
      <p class="boost-info">–¶–µ–Ω–∞: 500 –∫–ª–∏–∫–æ–≤</p>
      <button class="buy-button" id="buyCoins" data-cost="500" data-coins="1000">
        –ö—É–ø–∏—Ç—å –∑–∞ 500 –∫–ª–∏–∫–æ–≤
      </button>
    </div>
  </div>
</div>

<script>
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
  const tg = window.Telegram.WebApp;
  tg.expand();
  tg.ready();

  // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
  let score = 0;
  let totalClicks = 0;
  let clicksInSecond = 0;
  let record = localStorage.getItem('tapRecord') || 0;
  let coins = parseInt(localStorage.getItem('gameCoins')) || 0;
  let boostMultiplier = parseInt(localStorage.getItem('boostMultiplier')) || 1;

  // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
  const scoreElement = document.getElementById('score');
  const tapButton = document.getElementById('tapButton');
  const totalClicksElement = document.getElementById('totalClicks');
  const clicksPerSecondElement = document.getElementById('clicksPerSecond');
  const recordElement = document.getElementById('record');
  const resetButton = document.getElementById('resetButton');
  const shopButton = document.getElementById('shopButton');
  const shopModal = document.getElementById('shopModal');
  const closeShop = document.getElementById('closeShop');
  const coinsElement = document.getElementById('coins');
  const boostLevelElement = document.getElementById('boostLevel');
  const buyBoost2 = document.getElementById('buyBoost2');
  const buyBoost5 = document.getElementById('buyBoost5');
  const buyBoost10 = document.getElementById('buyBoost10');
  const buyCoins = document.getElementById('buyCoins');

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  function updateDisplay() {
    scoreElement.textContent = score;
    totalClicksElement.textContent = totalClicks;
    recordElement.textContent = record;
    coinsElement.textContent = coins;
    boostLevelElement.textContent = boostMultiplier + 'x';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–Ω–æ–ø–æ–∫ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
    updateShopButtons();
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–Ω–æ–ø–æ–∫ –º–∞–≥–∞–∑–∏–Ω–∞
  function updateShopButtons() {
    buyBoost2.disabled = coins < 1000;
    buyBoost5.disabled = coins < 5000;
    buyBoost10.disabled = coins < 10000;
    buyCoins.disabled = totalClicks < 500;
  }

  // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–∞
  function handleClick() {
    score++;
    totalClicks++;
    clicksInSecond++;
    coins += boostMultiplier; // –î–æ–±–∞–≤–ª—è–µ–º –º–æ–Ω–µ—Ç–∫–∏ —Å —É—á–µ—Ç–æ–º —É—Å–∏–ª–∏—Ç–µ–ª—è

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
    localStorage.setItem('gameCoins', coins);
    
    updateDisplay();

    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∫–æ—Ä–¥
    if (score > record) {
      record = score;
      recordElement.textContent = record;
      localStorage.setItem('tapRecord', record);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –º–æ–Ω–µ—Ç—ã
    tapButton.style.transform = 'scale(0.95) rotate(5deg)';
    setTimeout(() => {
      tapButton.style.transform = 'scale(1) rotate(0deg)';
    }, 100);
  }

  // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ —Å—á–µ—Ç–∞
  function resetScore() {
    score = 0;
    updateDisplay();
  }

  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
  function openShop() {
    shopModal.style.display = 'block';
    updateShopButtons();
  }

  function closeShopModal() {
    shopModal.style.display = 'none';
  }

  // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —É—Å–∏–ª–∏—Ç–µ–ª—è
  function buyBoost(cost, multiplier) {
    if (coins >= cost) {
      coins -= cost;
      boostMultiplier = multiplier;
      localStorage.setItem('gameCoins', coins);
      localStorage.setItem('boostMultiplier', boostMultiplier);
      updateDisplay();
      alert(`üéâ –£—Å–∏–ª–∏—Ç–µ–ª—å ${multiplier}x –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!`);
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ –º–æ–Ω–µ—Ç–æ–∫
  function buyBonusCoins(cost, bonusCoins) {
    if (totalClicks >= cost) {
      coins += bonusCoins;
      localStorage.setItem('gameCoins', coins);
      updateDisplay();
      alert(`üéâ –ü–æ–ª—É—á–µ–Ω–æ ${bonusCoins} –º–æ–Ω–µ—Ç–æ–∫!`);
    }
  }

  // –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
  setInterval(() => {
    clicksPerSecondElement.textContent = clicksInSecond;
    clicksInSecond = 0;
  }, 1000);

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
  tapButton.addEventListener('click', handleClick);
  resetButton.addEventListener('click', resetScore);
  shopButton.addEventListener('click', openShop);
  closeShop.addEventListener('click', closeShopModal);

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –º–∞–≥–∞–∑–∏–Ω–∞
  buyBoost2.addEventListener('click', () => buyBoost(1000, 2));
  buyBoost5.addEventListener('click', () => buyBoost(5000, 5));
  buyBoost10.addEventListener('click', () => buyBoost(10000, 10));
  buyCoins.addEventListener('click', () => buyBonusCoins(500, 1000));

  // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
  window.addEventListener('click', (event) => {
    if (event.target === shopModal) {
      closeShopModal();
    }
  });

  // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∞–ø–æ–≤ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
  tapButton.addEventListener('touchstart', function(e) {
    e.preventDefault();
    handleClick();
  });

  // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
  tapButton.addEventListener('click', function() {
    if (navigator.vibrate) {
      navigator.vibrate(10);
    }
  });

  // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–≤–æ–π–Ω–æ–≥–æ —Ç–∞–ø–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
  tapButton.addEventListener('touchend', function(e) {
    e.preventDefault();
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  updateDisplay();
</script>
</body>
</html>
